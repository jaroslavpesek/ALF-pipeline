---
- name: Clone ALF-pipeline repository
  git:
    repo: https://github.com/jaroslavpesek/ALF-pipeline.git
    dest: /opt/ALF-pipeline

- name: Build SALF
  shell: |
    cd /opt/ALF-pipeline/nemea_modules/salf
    autoreconf -i
    ./configure
    make
    make install

- name: Build cryptominer annotator
  shell: |
    cd /opt/ALF-pipeline/annotators/cryptominer
    autoreconf -i
    ./configure
    make
    make install

- name: Build pipeline from modules
  shell: |
    cp /opt/ALF-pipeline/config/nemea/salf.sup /etc/nemea/data-sources/.
    supcli -r